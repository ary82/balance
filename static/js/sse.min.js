!function(){var g;function t(e){return new EventSource(e,{withCredentials:!0})}function n(l){r(l,"sse-swap").forEach(function(a){var o=g.getClosestMatch(a,f);if(null==o)return null;for(var i=g.getInternalData(o).sseEventSource,e=g.getAttributeValue(a,"sse-swap").split(","),t=0;t<e.length;t++){var u=e[t].trim(),c=function(e){var t,n,r,s;v(o)||(g.bodyContains(a)?g.triggerEvent(l,"htmx:sseBeforeMessage",e)&&(t=a,n=e.data,g.withExtensions(t,function(e){n=e.transformResponse(n,null,t)}),r=g.getSwapSpecification(t),s=g.getTarget(t),g.swap(s,n,r),g.triggerEvent(l,"htmx:sseMessage",e)):i.removeEventListener(u,c))};g.getInternalData(a).sseEventListener=c,i.addEventListener(u,c)}}),r(l,"hx-trigger").forEach(function(t){var n=g.getClosestMatch(t,f);if(null==n)return null;var r,s=g.getInternalData(n).sseEventSource,a=g.getAttributeValue(t,"hx-trigger");null!=a&&"sse:"==a.slice(0,4)&&(r=function(e){v(n)||(g.bodyContains(t)||s.removeEventListener(a,r),htmx.trigger(t,a,e),htmx.trigger(t,"htmx:sseMessage",e))},g.getInternalData(l).sseEventListener=r,s.addEventListener(a.slice(4),r))})}function o(e,a){null!=e&&(r(e,"sse-connect").forEach(function(e){var t,n,r,s=g.getAttributeValue(e,"sse-connect");null!=s&&(t=e,n=a,(r=htmx.createEventSource(s)).onerror=function(e){g.triggerErrorEvent(t,"htmx:sseError",{error:e,source:r}),v(t)||r.readyState===EventSource.CLOSED&&(n=n||0,e=Math.random()*(2^n)*500,window.setTimeout(function(){o(t,Math.min(7,n+1))},e))},r.onopen=function(e){g.triggerEvent(t,"htmx:sseOpen",{source:r})},g.getInternalData(t).sseEventSource=r)}),n(e))}function v(e){if(!g.bodyContains(e)){e=g.getInternalData(e).sseEventSource;if(null!=e)return e.close(),1}}function r(e,t){var n=[];return g.hasAttribute(e,t)&&n.push(e),e.querySelectorAll("["+t+"], [data-"+t+"]").forEach(function(e){n.push(e)}),n}function f(e){return null!=g.getInternalData(e).sseEventSource}htmx.defineExtension("sse",{init:function(e){g=e,null==htmx.createEventSource&&(htmx.createEventSource=t)},onEvent:function(e,t){var n=t.target||t.detail.elt;switch(e){case"htmx:beforeCleanupElement":var r=g.getInternalData(n);return void(r.sseEventSource&&r.sseEventSource.close());case"htmx:afterProcessNode":o(n)}}})}();
